\documentclass[10pt]{article}
\usepackage[a4paper, total={7in, 9in}]{geometry}
\usepackage{hanging}
\usepackage{enumitem}
\usepackage{fontspec}
\usepackage{color}
\usepackage{setspace}
\usepackage{hyperref}
\usepackage{stackengine}

% Set margins.
\oddsidemargin=0.0in
\evensidemargin=0.0in
\textwidth=6.5in
\voffset=-0.125in
\headheight=0.0in
\topmargin=0.0in
\textheight=9.0in

\setmainfont{TeX Gyre Termes}

\renewcommand{\labelitemi}{-}
\renewcommand{\linespread}{1}

\setlength{\parindent}{0pt}
\setlength{\parskip}{0pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

\stackMath

\begin{document}

\begin{itemize}[noitemsep, nolistsep]
  \item
  Let $O$ be the matrix of optimally combined (OC) data, of shape ($v$, $t$)
  (where $v$ is the number of voxels in the brain mask and $t$ is the number of
  timepoints in the run).

  \item
  Let $M$ be the mixing matrix from the MEICA decomposition, of shape ($c$, $t$),
  where $c$ is the number of components.

  \item
  Let $n$ be the index of all non-ignored components in $M$, i.e., all accepted
  (BOLD-like) and rejected (non-BOLD) components.

  \item
  Let $a$ be the index of accepted (BOLD-like) components in $M$.
\end{itemize}

\bigskip

\begin{enumerate}[noitemsep, nolistsep]

  \item
  The voxel-wise means ($\mu_{O}$) and standard deviations ($\sigma_{O}$)
  of the optimally data are computed.

  \item
  The optimally combined data are z-normalized.
    \begin{equation}
      O_{z} = \frac{O - \mu_{O}}{\sigma_{O}}
    \end{equation}

  \item
  The betas $B$ for the MEICA mixing matrix $M$ fitted to the normalized data
  $O_{z}$ are computed.
  % no intercept included, because unnecessary and data are normalized.
    \begin{equation}
      O_{z} = B \cdot M + \epsilon
    \end{equation}

  \item
  The residuals $R$ using only the non-ignored components (indexed in $n$) are
  computed using the normalized data $O_{z}$, the betas $B$, and the mixing
  matrix $M$.
    \begin{equation}
      R = O_{z} - (B[:, n] \cdot M[n, :])
    \end{equation}

  \item
  The time series of BOLD-like components $P$ is constructed from the betas $B$,
  the mixing matrix $M$, and the index of accepted components $a$.
    \begin{equation}
      P = B[:, a] \cdot M[a, :]
    \end{equation}

  \item
  The voxel-wise minimum map of the T1-like effect $T$ (of shape $v$) is
  computed from the BOLD time series $P$, and is then mean-centered.
    \begin{equation}
      T_{i} = \min_{j\in{J}}x_{ij}, i = 1,...,m
    \end{equation}

    \begin{equation}
      T = T - \mu_{T}
    \end{equation}

  \item
  The volume-wise global signal timeseries $g$ based on the T1-like effect is
  computed with least squares regression.
    \begin{equation}
      O_{z} = Tg + \epsilon
    \end{equation}

  \item
  This global signal is removed from the BOLD timeseries $P$ with least squares
  regression to create $F$, which is multiplied by $g$ to create a predicted
  T1-like BOLD timeseries.
    \begin{equation}
      P^T = g^{T}F + \epsilon
    \end{equation}
    \begin{equation}
      P_{c} = P - (F \cdot g)
    \end{equation}

  \item
  The BOLD timeseries (ME-HK+MIR, $H$), scaled to match the real data, is
  constructed from $P_{c}$ and $\sigma_{O}$.
    \begin{equation}
      {H} = \sigma_{O}P_{c}
    \end{equation}

  \item
  The denoised timeseries (ME-DN+MIR, $D$) is constructed from $P_{c}$, $\sigma_{O}$,
  $\mu_{O}$, and $R$.
    \begin{equation}
      {D} = \sigma_{O}(P_{c} + R) + \mu_{O}
    \end{equation}

\end{enumerate}

\begin{center}
\begin{tabular}{ |c|c|c| }
 \hline
 Symbol & Shape & Description \\
 \hline
 $v$ & & Number of voxels after masking \\
 $t$ & & Number of volumes \\
 $c$ & & Number of components from MEICA \\
 $O$ & v, t & Optimally combined data \\
 $O_{z}$ & v, t & Z-normalized optimally combined data \\
 $M$ & c, t & Mixing matrix (component timeseries) from MEICA \\
 $n$ & <c & Index of all non-ignored (accepted and rejected) components in $M$ \\
 $a$ & <c & Index of accepted, BOLD-like components in $M$ \\
 $B$ & v, c & Voxel-wise beta values for components in $M$ fitted to $O_{z}$ \\
 $R$ & v, t & Data not accounted for by accepted and rejected MEICA components fitted to $O_{z}$ \\
 $P$ & v, t & Reconstructed BOLD-like component timeseries \\
 $T$ & v & Map of T1-like effect \\  % should this be lower case? But t is already time...
 $g$ & t & Time series of T1-like global signal \\
 $P_{c}$ & v, t & Predicted T1-like BOLD timeseries \\
 $H$ & v, t & High-Kappa (aka BOLD) timeseries, minus impact of T1-like effect \\
 $D$ & v, t & Denoised (BOLD + ignored, but no rejected) timeseries, minus effect of T1-like effect \\
 \hline
\end{tabular}
\end{center}



\end{document}
